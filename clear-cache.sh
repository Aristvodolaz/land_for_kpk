#!/bin/bash

# ============================================
# –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
# ============================================

echo "üîÑ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞..."

# ============================================
# 1. NGINX
# ============================================

if command -v nginx &> /dev/null; then
    echo "‚Üí –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Nginx..."
    
    # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Nginx (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
    sudo rm -rf /var/cache/nginx/*
    
    # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
    sudo systemctl reload nginx
    
    echo "‚úì Nginx: –∫—ç—à –æ—á–∏—â–µ–Ω"
fi

# ============================================
# 2. APACHE
# ============================================

if command -v apache2 &> /dev/null; then
    echo "‚Üí –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Apache..."
    
    # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Apache
    sudo systemctl reload apache2
    
    echo "‚úì Apache: –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω"
fi

# ============================================
# 3. CLOUDFLARE (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
# ============================================

# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Cloudflare:
# 
# ZONE_ID="your_zone_id"
# API_TOKEN="your_api_token"
# 
# echo "‚Üí –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Cloudflare..."
# 
# curl -X POST "https://api.cloudflare.com/client/v4/zones/$ZONE_ID/purge_cache" \
#      -H "Authorization: Bearer $API_TOKEN" \
#      -H "Content-Type: application/json" \
#      --data '{"purge_everything":true}'
# 
# echo "‚úì Cloudflare: –∫—ç—à –æ—á–∏—â–µ–Ω"

# ============================================
# 4. –§–ê–ô–õ–´ –ö–≠–®–ê –°–¢–ê–¢–ò–ö–ò
# ============================================

echo "‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ —Ñ–∞–π–ª–æ–≤..."

# –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É CSS (—ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç cache busting)
touch /var/www/landing/css/style.css

echo "‚úì –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã"

# ============================================
# –ó–ê–í–ï–†–®–ï–ù–ò–ï
# ============================================

echo ""
echo "‚úÖ –ö—ç—à –æ—á–∏—â–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
echo ""
echo "–¢–µ–ø–µ—Ä—å:"
echo "1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Ctrl+Shift+R)"
echo "2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É CSS –≤ DevTools (Network ‚Üí style.css)"
echo ""
